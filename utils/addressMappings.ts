// utils/addressMappings.ts

// This file is the single source of truth for all address-related data mappings.

/**
 * A map for normalizing common address misspellings, abbreviations, and non-standard formats
 * before the main parsing logic begins.
 */
export const CITY_NORMALIZATION_MAP: Record<string, string> = {
  'калининрад': 'калининград',
  'калининграл': 'калининград',
  'г,гурьевск': 'гурьевск', // Handled by string cleaning, but good as a fallback
  'ул.калининград': 'калининград', // A pattern, but direct replacement can help
  'пос. большое исаково': 'большое исаково',
  'б. исаково': 'большое исаково',
  'пгт чкаловск': 'чкаловск',
  'кал-я обл': 'калининградская область',
  'калининградскаяобл': 'калининградская область',
  'лен.обл': 'ленинградская область',
  'ленобл': 'ленинградская область',
  'ло': 'ленинградская область',
  'снкт-петербург': 'санкт-петербург',
};


/**
 * A comprehensive mapping of regional centers and major cities to their regions.
 * This is the primary data source for determining a region based on a found city.
 * Moved from `regionCenters.ts` for centralization.
 */
export const REGION_BY_CITY_MAP: Record<string, string> = {
  // --- Russian Federation (Capitals and Major Cities) ---
  "москва": "Москва",
  "санкт-петербург": "Санкт-Петербург",
  "спб": "Санкт-Петербург",
  "севастополь": "Севастополь",
  "абакан": "Республика Хакасия",
  "анадырь": "Чукотский автономный округ",
  "архангельск": "Архангельская область",
  "астрахань": "Астраханская область",
  "барнаул": "Алтайский край",
  "белгород": "Белгородская область",
  "биробиджан": "Еврейская автономная область",
  "благовещенск": "Амурская область",
  "брянск": "Брянская область",
  "великий новгород": "Новгородская область",
  "владивосток": "Приморский край",
  "владикавказ": "Республика Северная Осетия — Алания",
  "моздок": "Республика Северная Осетия — Алания",
  "беслан": "Республика Северная Осетия — Алания",
  "алагир": "Республика Северная Осетия — Алания",
  "ардон": "Республика Северная Осетия — Алания",
  "владимир": "Владимирская область",
  "волгоград": "Волгоградская область",
  "вологда": "Вологодская область",
  "воронеж": "Воронежская область",
  "горно-алтайск": "Республика Алтай",
  "грозный": "Чеченская Республика",
  "гудермес": "Чеченская Республика",
  "аргун": "Чеченская Республика",
  "шали": "Чеченская Республика",
  "урус-мартан": "Чеченская Республика",
  "екатеринбург": "Свердловская область",
  "иваново": "Ивановская область",
  "ижевск": "Удмуртская Республика",
  "иркутск": "Иркутская область",
  "йошкар-ола": "Республика Марий Эл",
  "казань": "Республика Татарстан",

  // Donetsk People's Republic
  "донецк": "Донецкая Народная Республика",
  "макеевка": "Донецкая Народная Республика",
  "мариуполь": "Донецкая Народная Республика",
  "енакиево": "Донецкая Народная Республика",
  "шахтерск": "Донецкая Народная Республика",
  "торез": "Донецкая Народная Республика",
  "снежное": "Донецкая Народная Республика",
  "харцызск": "Донецкая Народная Республика",
  
  // Zaporozhye Oblast
  "запорожье": "Запорожская область",
  "мелитополь": "Запорожская область",
  "бердянск": "Запорожская область",
  "геническ": "Запорожская область",
  
  // Kaliningrad Oblast
  "калининград": "Калининградская область",
  "гвардейск": "Калининградская область",
  "светлый": "Калининградская область",
  "зеленоградск": "Калининградская область",
  "гурьевск": "Калининградская область",
  "пионерский": "Калининградская область",
  "советск": "Калининградская область",
  "светлогорск": "Калининградская область",
  "багратионовск": "Калининградская область",
  "черняховск": "Калининградская область",
  "балтийск": "Калининградская область",
  "большое исаково": "Калининградская область",
  "голубево": "Калининградская область",
  "васильково": "Калининградская область",
  "чкаловск": "Калининградская область",
  "матросово": "Калининградская область",
  "прибрежное": "Калининградская область",
  "правдинск": "Калининградская область",
  
  "калуга": "Калужская область",
  "кемерово": "Кемеровская область",
  "киров": "Калужская область", // Note: A town in Kaluga Oblast. The capital of Kirov Oblast is also Kirov.
  "кострома": "Костромская область",
  "краснодар": "Краснодарский край",
  "красноярск": "Красноярский край",
  "курган": "Курганская область",
  "курск": "Курская область",
  "кызыл": "Республика Тыва",
  "липецкая": "Липецкая область",
  "ливны": "Орловская область",
  "луганск": "Луганская Народная Республика",
  "людиново": "Калужская область",
  "магадан": "Магаданская область",
  "магас": "Республика Ингушетия",
  "назрань": "Республика Ингушетия",
  "сунжа": "Республика Ингушетия",
  "карабулак": "Республика Ингушетия",
  "малгобек": "Республика Ингушетия",
  "майкоп": "Республика Адыгея",
  "махачкала": "Республика Дагестан",
  "дербент": "Республика Дагестан",
  "каспийск": "Республика Дагестан",
  "хасавюрт": "Республика Дагестан",
  "буйнакск": "Республика Дагестан",
  "кизляр": "Республика Дагестан",
  "избербаш": "Республика Дагестан",
  "мурманск": "Мурманская область",
  "нальчик": "Кабардино-Балкарская Республика",
  "прохладный": "Кабардино-Балкарская Республика",
  "баксан": "Кабардино-Балкарская Республика",
  "нарткала": "Кабардино-Балкарская Республика",
  "майский": "Кабардино-Балкарская Республика",
  "терек": "Кабардино-Балкарская Республика",
  "чегем": "Кабардино-Балкарская Республика",
  "нарьян-мар": "Ненецкий автономный округ",
  "нижний новгород": "Нижегородская область",
  "новосибирск": "Новосибирская область",
  "омск": "Омская область",
  "орёл": "Орловская область",
  "орел": "Орловская область",
  "оренбург": "Оренбургская область",
  "пенза": "Пензенская область",
  "пермь": "Пермский край",
  "петрозаводск": "Республика Карелия",
  "петропавловск-камчатский": "Камчатский край",
  "псков": "Псковская область",
  "ростов-на-дону": "Ростовская область",
  "рязань": "Рязанская область",
  "салехард": "Ямало-Ненецкий автономный округ",
  "самара": "Самарская область",
  "саранск": "Республика Мордовия",
  "саратов": "Саратовская область",
  "симферополь": "Республика Крым",
  "смоленск": "Смоленская область",
  "сочи": "Краснодарский край",
  "ставрополь": "Ставропольский край",
  "михайловск": "Ставропольский край",
  "пятигорск": "Ставропольский край",
  "кисловодск": "Ставропольский край",
  "невинномысск": "Ставропольский край",
  "ессентуки": "Ставропольский край",
  "минеральные воды": "Ставропольский край",
  "георгиевск": "Ставропольский край",
  "буденновск": "Ставропольский край",
  "изобильный": "Ставропольский край",
  "светлоград": "Ставропольский край",
  "зеленокумск": "Ставропольский край",
  "новоалександровск": "Ставропольский край",
  "ипатово": "Ставропольский край",
  "сыктывкар": "Республика Коми",
  "тамбов": "Тамбовская область",
  "тверь": "Тверская область",
  "томск": "Томская область",
  "тула": "Тульская область",
  "тюмень": "Тюменская область",
  "улан-удэ": "Республика Бурятия",
  "ульяновск": "Ульяновская область",
  "уфа": "Республика Башкортостан",
  "хабаровск": "Хабаровский край",
  "ханты-мансийск": "Ханты-Мансийский автономный округ - Югра",
  "херсон": "Херсонская область",
  "чебоксары": "Чувашская Республика",
  "челябинск": "Челябинская область",
  "черкесск": "Карачаево-Черкесская Республика",
  "усть-джегута": "Карачаево-Черкесская Республика",
  "карачаевск": "Карачаево-Черкесская Республика",
  "зеленчукская": "Карачаево-Черкесская Республика",
  "чита": "Забайкальский край",
  "элиста": "Республика Калмыкия",
  "южно-сахалинск": "Сахалинская область",
  "якутск": "Республика Саха (Якутия)",
  "ярославль": "Ярославская область",

  // Leningrad Oblast & Cities within St. Petersburg Federal City
  "кудрово": "Ленинградская область",
  "мурино": "Ленинградская область",
  "всеволожск": "Ленинградская область",
  "выборг": "Ленинградская область",
  "гатчина": "Ленинградская область",
  "сосновый бор": "Ленинградская область",
  "кировск": "Ленинградская область",
  "тосно": "Ленинградская область",
  "коммунар": "Ленинградская область",
  "тихвин": "Ленинградская область",
  "сланцы": "Ленинградская область",
  "приозерск": "Ленинградская область",
  "волхов": "Ленинградская область",
  "кириши": "Ленинградская область",
  "кингисепп": "Ленинградская область",
  "сиверский": "Ленинградская область",
  "луга": "Ленинградская область",
  "волосово": "Ленинградская область",
  "ивангород": "Ленинградская область",
  "подпорожье": "Ленинградская область",
  "токсово": "Ленинградская область",
  "мга": "Ленинградская область",
  "сертолово": "Ленинградская область",
  "лодейное поле": "Ленинградская область",
  "ломоносов": "Санкт-Петербург",
  "колпино": "Санкт-Петербург",
  "пушкин": "Санкт-Петербург",
  "петергоф": "Санкт-Петербург",
  "сестрорецк": "Санкт-Петербург",
  "кронштадт": "Санкт-Петербург",
  "павловск": "Санкт-Петербург",
  "зеленогорск": "Санкт-Петербург",
  "понтонный": "Санкт-Петербург",

  // --- CIS Countries ---
  "минск": "Республика Беларусь",
  "гомель": "Республика Беларусь",
  "брест": "Республика Беларусь",
  "астана": "Республика Казахстан",
  "алматы": "Республика Казахстан",
  "бишкек": "Кыргызская Республика",
  "душанбе": "Республика Таджикистан",
  "ашхабад": "Туркменистан",
  "ташкент": "Республика Узбекистан",
  "ереван": "Армения",
  "баку": "Азербайджан",
  "кишинёв": "Республика Молдова",
  "киев": "Украина",
  "харьков": "Украина",
  
  // --- Unrecognized & Partially Recognized States ---
  "тирасполь": "Приднестровская Молдавская Республика",
  "сухум": "Республика Абхазия",
  "цхинвал": "Республика Южная Осетия",
  "степанакерт": "Нагорно-Карабахская Республика",
  "никосия": "Турецкая Республика Северного Кипра",
  "приштина": "Республика Косово",
};

/**
 * A comprehensive mapping of various region name formats (keywords, abbreviations, common misspellings)
 * to the single, official, standardized region name. This is the heart of Priority 1 parsing.
 * Keys are all lowercase for case-insensitive matching.
 */
export const REGION_KEYWORD_MAP: Record<string, string> = {
  // --- Russian Federation (89 Subjects) ---
  // Republics (24)
  'адыгея': 'Республика Адыгея',
  'респ алтай': 'Республика Алтай',
  'башкортостан': 'Республика Башкортостан', 'башкирия': 'Республика Башкортостан',
  'бурятия': 'Республика Бурятия',
  'дагестан': 'Республика Дагестан',
  'ингушетия': 'Республика Ингушетия',
  'кбр': 'Кабардино- Балкарская Республика', 'кабардино-балкария': 'Кабардино- Балкарская Республика',
  'калмыкия': 'Республика Калмыкия',
  'кчр': 'Карачаево-Черкесская Республика', 'карачаево-черкесия': 'Карачаево-Черкесская Республика',
  'карелия': 'Республика Карелия',
  'коми': 'Республика Коми',
  'крым': 'Республика Крым',
  'марий эл': 'Республика Марий Эл',
  'мордовия': 'Республика Мордовия',
  'саха': 'Республика Саха (Якутия)', 'якутия': 'Республика Саха (Якутия)',
  'северная осетия': 'Республика Северная Осетия — Алания', 'алания': 'Республика Северная Осетия — Алания',
  'татарстан': 'Республика Татарстан',
  'тыва': 'Республика Тыва', 'тува': 'Республика Тыва',
  'удмуртия': 'Удмуртская Республика',
  'хакасия': 'Республика Хакасия',
  'чечня': 'Чеченская Республика', 'чеченская': 'Чеченская Республика',
  'чувашия': 'Чувашская Республика', 'чувашская': 'Чувашская Республика',
  'днр': 'Донецкая Народная Республика', 'донецкая народная республика': 'Донецкая Народная Республика',
  'лнр': 'Луганская Народная Республика', 'луганская народная республика': 'Луганская Народная Республика',
  
  // Krais (9)
  'алтайский край': 'Алтайский край',
  'забайкальский край': 'Забайкальский край',
  'камчатский край': 'Камчатский край',
  'краснодарский край': 'Краснодарский край', 'кубань': 'Краснодарский край',
  'красноярский край': 'Красноярский край',
  'пермский край': 'Пермский край',
  'приморский край': 'Приморский край',
  'ставропольский край': 'Ставропольский край',
  'хабаровский край': 'Хабаровский край',

  // Oblasts (48)
  'амурская': 'Амурская область',
  'архангельская': 'Архангельская область',
  'астраханская': 'Астраханская область',
  'белгородская': 'Белгородская область',
  'брянская': 'Брянская область',
  'брянская обл': 'Брянская область',
  'обл брянская': 'Брянская область',
  'брянская область': 'Брянская область',
  'владимирская': 'Владимирская область',
  'волгоградская': 'Волгоградская область',
  'вологодская': 'Вологодская область',
  'воронежская': 'Воронежская область',
  'ивановская': 'Ивановская область',
  'иркутская': 'Иркутская область',
  'калининградская': 'Калининградская область',
  'калужская': 'Калужская область',
  'калужская обл': 'Калужская область',
  'обл калужская': 'Калужская область',
  'калужская область': 'Калужская область',
  'кемеровская': 'Кемеровская область', 'кузбасс': 'Кемеровская область',
  'кировская': 'Кировская область',
  'костромская': 'Костромская область',
  'курганская': 'Курганская область',
  'курская': 'Курская область',
  'ленинградская': 'Ленинградская область', 'ленобласть': 'Ленинградская область',
  'липецкая': 'Липецкая область',
  'магаданская': 'Магаданская область',
  'московская': 'Московская область', 'мособласть': 'Московская область', 'подмосковье': 'Московская область',
  'мурманская': 'Мурманская область',
  'нижегородская': 'Нижегородская область',
  'новгородская': 'Новгородская область',
  'новосибирская': 'Новосибирская область',
  'омская': 'Омская область',
  'оренбургская': 'Оренбургская область',
  'орловская': 'Орловская область',
  'орловская обл': 'Орловская область',
  'обл орловская': 'Орловская область',
  'орловская область': 'Орловская область',
  'пензенская': 'Пензенская область',
  'псковская': 'Псковская область',
  'ростовская': 'Ростовская область',
  'рязанская': 'Рязанская область',
  'самарская': 'Самарская область',
  'саратовская': 'Саратовская область',
  'сахалинская': 'Сахалинская область',
  'свердловская': 'Свердловская область',
  'смоленская': 'Смоленская область',
  'смоленская обл': 'Смоленская область',
  'обл смоленская': 'Смоленская область',
  'смоленская область': 'Смоленская область',
  'тамбовская': 'Тамбовская область',
  'тверская': 'Тверская область',
  'томская': 'Томская область',
  'тульская': 'Тульская область',
  'тюменская': 'Тюменская область',
  'ульяновская': 'Ульяновская область',
  'челябинская': 'Челябинская область',
  'ярославская': 'Ярославская область',
  'запорожская': 'Запорожская область', 'запорожская обл': 'Запорожская область',
  'херсонская': 'Херсонская область', 'херсонская обл': 'Херсонская область',

  // Federal Cities (3)
  // Note: These are also in REGION_BY_CITY_MAP, but having them here helps catch cases where the city name is used as the region.
  'москва': 'Москва',
  'санкт-петербург': 'Санкт-Петербург',
  'севастополь': 'Севастополь',

  // Autonomous Okrugs (4)
  'ненецкий ао': 'Ненецкий автономный округ',
  'хмао': 'Ханты-Мансийский автономный округ - Югра', 'югра': 'Ханты-Мансийский автономный округ - Югра',
  'чукотский ао': 'Чукотский автономный округ', 'чукотка': 'Чукотский автономный округ',
  'янао': 'Ямало-Ненецкий автономный округ', 'ямал': 'Ямало-Ненецкий автономный округ',

  // Autonomous Oblast (1)
  'еврейская ао': 'Еврейская автономная область',
  
  // --- CIS Countries ---
  'азербайджан': 'Азербайджан',
  'армения': 'Армения',
  'беларусь': 'Республика Беларусь', 'белоруссия': 'Республика Беларусь',
  'казахстан': 'Республика Казахстан',
  'киргизия': 'Кыргызская Республика', 'кыргызстан': 'Кыргызская Республика',
  'молдова': 'Республика Молдова', 'молдавия': 'Республика Молдова',
  'таджикистан': 'Республика Таджикистан',
  'туркменистан': 'Туркменистан',
  'узбекистан': 'Республика Узбекистан',
  'украина': 'Украина',

  // --- Unrecognized & Partially Recognized States ---
  'абхазия': 'Республика Абхазия',
  'южная осетия': 'Республика Южная Осетия',
  'приднестровье': 'Приднестровская Молдавская Республика', 'пмр': 'Приднестровская Молдавская Республика',
  'нагорный карабах': 'Нагорно-Карабахская Республика', 'арцах': 'Нагорно-Карабахская Республика',
  'северный кипр': 'Турецкая Республика Северного Кипра',
  'косово': 'Республика Косово',
};


/**
 * Mapping of postal indexes (full or prefixed) to their corresponding region.
 * Used as a fallback for address parsing.
 */
export const INDEX_MAP: Record<string, string> = {
    // Specific codes from user prompt
    '32038': 'Орловская область',
    '249440': 'Калужская область',
    '249406': 'Калужская область',
    '3022005': 'Орловская область',

    // Central Federal District
    '241': 'Брянская область', '242': 'Брянская область', '243': 'Брянская область',
    '302': 'Орловская область', '303': 'Орловская область',
    '214': 'Смоленская область', '215': 'Смоленская область', '216': 'Смоленская область',
    '305': 'Курская область',
    '308': 'Белгородская область',
    '394': 'Воронежская область',
    '10': 'Москва', '11': 'Москва', '12': 'Москва',
    '14': 'Московская область',
    // New Regions
    '28': 'Херсонская область', // Generally, 28xxxx is Amur, but new codes are assigned. This is a placeholder.
    '29': 'Республика Крым', // Generally Arkhangelsk
    '83': 'Донецкая Народная Республика', // Custom prefix
    '84': 'Донецкая Народная Республика', // Custom prefix
    '91': 'Луганская Народная Республика', // Custom prefix
    '92': 'Луганская Народная Республика', // Custom prefix
    // CIS Countries (example prefixes)
    '220': 'Республика Беларусь', // Minsk
    '010': 'Республика Казахстан', // Astana
};


/**
 * Standardizes a given region string by looking it up in the comprehensive keyword map.
 * This is the single source of truth for region name normalization throughout the app.
 * @param input The raw region string.
 * @returns The standardized, official region name or the original input if no match is found.
 */
export const standardizeRegion = (input: string | null | undefined): string => {
    if (!input) return '';
    const lowerInput = input.toLowerCase().trim();
    // Direct match check first
    if (REGION_KEYWORD_MAP[lowerInput]) {
        return REGION_KEYWORD_MAP[lowerInput];
    }
    // Check if the input contains any of the keys
    for (const key in REGION_KEYWORD_MAP) {
        if (lowerInput.includes(key)) {
            return REGION_KEYWORD_MAP[key];
        }
    }
    // Return the original formatted nicely if no match
    return input.trim();
};
